{% extends 'base.html' %}
{% block content %}
<div class="container py-4">
	<h2 class="section-header">Our Menu</h2>
	<form class="row g-3 align-items-end mt-1" method="get">
		<div class="col-md-4">
			<label class="form-label">Category</label>
			<select class="form-select" name="category">
				<option value="">All</option>
				{% for c in all_categories %}
					<option value="{{ c }}" {% if selected_category==c %}selected{% endif %}>{{ c }}</option>
				{% endfor %}
			</select>
		</div>
		<div class="col-md-4">
			<label class="form-label">Type</label>
			<select class="form-select" name="type">
				<option value="">All</option>
				{% for t in all_types %}
					<option value="{{ t }}" {% if selected_type==t %}selected{% endif %}>{{ t }}</option>
				{% endfor %}
			</select>
		</div>
		<div class="col-md-4">
			<button class="btn btn-primary"><i class="fa-solid fa-filter me-1"></i>Filter</button>
			<a class="btn btn-outline-secondary" href="{{ url_for('menu') }}">Reset</a>
		</div>
	</form>

	<div class="row g-4 mt-1">
		{% for p in products %}
			<div class="col-12 col-sm-6 col-lg-3">
				<div class="card product-card h-100">
					<img class="product-img" src="https://source.unsplash.com/600x400/?{{ 'tea' if p.category=='Tea' else 'coffee' }}" alt="{{ p.name }}">
					<div class="card-body">
						<div class="d-flex justify-content-between align-items-start">
							<h5 class="card-title">{{ p.name }}</h5>
							<span class="badge badge-category">{{ p.category }}</span>
						</div>
						<div class="d-flex gap-2 small mt-1">
							<span class="badge badge-type">{{ p.product_type }}</span>
						</div>
						<p class="small mt-2">{{ p.description[:100] }}{% if p.description|length > 100 %}...{% endif %}</p>
						<div class="d-flex justify-content-between align-items-center mt-3">
							<span class="fw-semibold">{{ p.price|currency }}</span>
							<div class="btn-group">
								<a href="{{ url_for('product_detail', product_id=p.id) }}" class="btn btn-sm btn-outline-secondary">Details</a>
								<button class="btn btn-sm btn-primary" onclick="BREW.addToCart({{ p.id }}, 1)"><i class="fa-solid fa-cart-plus me-1"></i>Add</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		{% else %}
			<div class="col-12"><div class="alert alert-info">No products found.</div></div>
		{% endfor %}
	</div>
</div>
{% endblock %}